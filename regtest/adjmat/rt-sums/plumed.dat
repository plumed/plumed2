# Test of row/column sums for symmetric matrix

mat: CONTACT_MATRIX GROUP=1-10 SWITCH={RATIONAL R_0=1.0} 
csums: COORDINATIONNUMBER WEIGHT=mat.w USECOLS
csums_mean: COMBINE ARG=csums NORMALIZE PERIODIC=NO
rsums: COORDINATIONNUMBER WEIGHT=mat.w 
rsums_mean: COMBINE ARG=rsums NORMALIZE PERIODIC=NO

COORDINATIONNUMBER SPECIES=1-10 SWITCH={RATIONAL R_0=1.0} MEAN LABEL=c1
PRINT ARG=c1.*,csums_mean,rsums_mean STRIDE=1 FILE=colvar FMT=%8.4f
 
# Test of row/column sums + around for symmetric matrix

ac: AROUND ORIGIN=1 ATOMS=1-10 SIGMA=0.2 XLOWER=-1.0 XUPPER=1.0
acp: MATHEVAL ARG1=csums ARG2=ac FUNC=x*y PERIODIC=NO
a1_numer: COMBINE ARG=acp PERIODIC=NO
a1_denom: COMBINE ARG=ac PERIODIC=NO
a1_mean: MATHEVAL ARG1=a1_numer ARG2=a1_denom FUNC=x/y PERIODIC=NO
AROUND ORIGIN=1 DATA=rsums ATOMS=1-10 SIGMA=0.2 XLOWER=-1.0 XUPPER=1.0 MEAN LABEL=a2
AROUND ORIGIN=1 DATA=c1 SIGMA=0.2 XLOWER=-1.0 XUPPER=1.0 MEAN LABEL=a3

PRINT ARG=a1_mean,a2.*,a3.* FILE=colv-around FMT=%8.4f

# Test of row/column sums for rectangular matrix

CONTACT_MATRIX GROUPA=1-5 GROUPB=6-15 SWITCH={RATIONAL R_0=1.0} LABEL=mat2 
rsums2: COORDINATIONNUMBER WEIGHT=mat2.w 
rsums2_mean: COMBINE ARG=rsums2 NORMALIZE PERIODIC=NO
csums2: COORDINATIONNUMBER WEIGHT=mat2.w USECOLS
csums2_mean: COMBINE ARG=csums2 NORMALIZE PERIODIC=NO 

COORDINATIONNUMBER SPECIESA=1-5 SPECIESB=6-15 SWITCH={RATIONAL R_0=1.0} MEAN LABEL=c1r
COORDINATIONNUMBER SPECIESA=6-15 SPECIESB=1-5 SWITCH={RATIONAL R_0=1.0} MEAN LABEL=c1c

PRINT ARG=c1r.*,rsums2_mean,c1c.*,csums2_mean FILE=colv2 FMT=%8.4f

# Test of row/column sums + around for rectangular matrix

ac2: AROUND ORIGIN=6 ATOMS=6-15 SIGMA=0.2 XLOWER=-1.0 XUPPER=1.0
acp2: MATHEVAL ARG1=csums2 ARG2=ac2 FUNC=x*y PERIODIC=NO
a4_numer: COMBINE ARG=acp2 PERIODIC=NO
a4_denom: COMBINE ARG=ac2 PERIODIC=NO
a4_mean: MATHEVAL ARG1=a4_numer ARG2=a4_denom FUNC=x/y PERIODIC=NO
AROUND ORIGIN=6 DATA=c1c SIGMA=0.2 XLOWER=-1.0 XUPPER=1.0 MEAN LABEL=a5
AROUND ORIGIN=1 DATA=rsums2 ATOMS=1-5 SIGMA=0.2 XLOWER=-1.0 XUPPER=1.0 MEAN LABEL=a6
AROUND ORIGIN=1 DATA=c1r SIGMA=0.2 XLOWER=-1.0 XUPPER=1.0 MEAN LABEL=a7

PRINT ARG=a4_mean,a5.*,a6.*,a7.* FILE=colv-around-2 FMT=%8.4f

