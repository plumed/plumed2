d1: READ FILE=plumed.in VALUES=c1
d2: READ FILE=plumed.in VALUES=c2
d3: READ FILE=plumed.in VALUES=c3

ff: COLLECT_FRAMES ARG1=d1 ARG2=d2 ARG3=d3
dd: VSTACK ARG1=ff.d1 ARG2=ff.d2 ARG3=ff.d3 
ddT: TRANSPOSE ARG=dd
oo: DISSIMILARITIES SQUARED ARG1=dd ARG2=ddT
ll: LANDMARK_SELECT_STRIDE DATA=ff ARG1=oo NLANDMARKS=250


# Calculate the weights
voro: VORONOI ARG=ll.oo_rect
weights: CUSTOM ARG1=ff.logweights FUNC=exp(x) PERIODIC=NO
lwe: DOT ARG1=voro ARG2=weights

smap: SKETCHMAP ...
  DISSIMILARITIES=ll.oo_sqr NLOW_DIM=2 PROJECT_ALL
  WEIGHTS=lwe HIGH_DIM_FUNCTION={SMAP R_0=4 A=3 B=2} 
  LOW_DIM_FUNCTION={SMAP R_0=4 A=1 B=2} CGTOL=1E-4 OS_CGTOL=1E-3 
...

PRINT ARG=smap.*,lwe FMT=%8.4f FILE=smap
PRINT ARG=smap_osample.coord-1,smap_osample.coord-2,weights FILE=projections FMT=%8.2f
