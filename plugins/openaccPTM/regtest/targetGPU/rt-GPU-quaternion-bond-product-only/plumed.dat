LOAD FILE=../../../../plumedOpenACC.so
quat: QUATERNION ATOMS1=1,2,3 ATOMS2=4,5,6 ATOMS3=7,8,9
c1: DISTANCE_MATRIX GROUP=1,4,7 CUTOFF=100.0 COMPONENTS
qp: QUATERNION_BOND_PRODUCT_MATRIX ARG=quat.*,c1.*  USEGPU

ones: ONES SIZE=3

sdot: MATRIX_VECTOR_PRODUCT ARG=qp.*,ones
sw: SUM ARG=sdot.w PERIODIC=NO
si: SUM ARG=sdot.i PERIODIC=NO
sj: SUM ARG=sdot.j PERIODIC=NO
sk: SUM ARG=sdot.k PERIODIC=NO

BIASVALUE ARG=sw
BIASVALUE ARG=si
BIASVALUE ARG=sj
BIASVALUE ARG=sk
PRINT ARG=sdot.*,sw,si,sj,sk FILE=colvar FMT=%8.4f
